<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Random Color Generator</title>
    <script src="https://unpkg.com/react@16/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@16/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/babel-standalone@6.15.0/babel.min.js"></script>
    <link rel="stylesheet" href="generator.css"></link>
  </head>
  <body>
    <div id="root"></div>
    <script type="text/babel">

    class RandomColor extends React.Component {
      constructor() {
        super();
        this.mouseDown = this.mouseDown.bind(this);
        this.mouseUp = this.mouseUp.bind(this);
        this.state = {
          color: this.formatColor([50, 100, 80]),
          dark: true
        }
      }

      /**
        * Returns a random array of colors.
        */
      findColor() {
        for (var i = 0, random = []; i < 3; i++) {
          random.push(Math.floor(Math.random()*256));
        }

        return random;
      }

      /**
        * Determines if an array of colors is light or dark to the human eye.
        */
      isColorDark(color) {
        var avg =  1 - ( 0.299 * color[0] + 0.587 * color[1] + 0.114 * color[2])/255;

        return (avg > 0.5);
      }

      /**
        * Formats an array of colors to an RGB format.
        */
      formatColor(color) {
        return 'rgb(' + color.join(', ') + ')';
      }

      /**
        * Finds a new random color and updates the state.
        */
      changeColor() {
        var newColor = this.findColor(); //Find new color

        //Updating states
        this.setState({color: this.formatColor(newColor)});
        this.setState({dark: this.isColorDark(newColor)});
      }

      mouseDown(e) {
        e.preventDefault();
      }

      mouseUp(e) {
        e.preventDefault();
        this.changeColor();
      }

      /**
        * Defines the rendering for the RandomColor.
        */
      render() {
        const colorNameCss = {display: 'inline-block', color: (this.state.dark ? 'white' : 'black')};
        var colorBlockCss = {height: '550px', width: '500px', background: this.state.color};

        return (
          <div style={colorBlockCss}>
            <div className="footer">
              <h1 style={colorNameCss}>{this.state.color}</h1>
              <div className={this.state.dark ? 'light btn' : 'dark btn'} onMouseDown={this.mouseDown} onMouseUp={this.mouseUp}>
                <h1>Refresh</h1>
              </div>
            </div>
          </div>
        );
      }
    }

    ReactDOM.render(
      <RandomColor />,
      document.getElementById('root')
    );


    </script>
  </body>
</html>
